<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width">
    <script src="https://d3js.org/d3.v4.min.js"></script>
    <title>Basic Scatter Plot</title>
    <style>
      body {
        margin: 0px
      }

      .halign {
        text-align: center;
      }

      .center {
          margin: auto;
          width: 1100px;
      }
    </style>


  </head>
  <body>
    <h1 class="halign" style="color: #d11245">Air Quality Analysis - NO2 vs SO2</h1>
    <h2 class="halign" style="margin-bottom:25px; color: #14a5c9">Neelesh Kumar Boddu</h2>


    <div class="center" style="margin-bottom:50px">
      <svg width="1100" height="500" ></svg>
    </div>
    <h4 class="halign" style="color: #d11245">Data description and context</h4>
    <h4 class="halign" style="color: #14a5c9">Background and class expectation:</h4>
    <p></p>

    <script>
      const xValue = d => d.NO2;
      const yValue = d => d.SO2;
      const margin = { left: 70, right: 20, top: 20, bottom: 50 };

      const svg = d3.select('svg');
      const width = svg.attr('width');
      const height = svg.attr('height');
      const innerWidth = width - margin.left - margin.right;
      const innerHeight = height - margin.top - margin.bottom;

      const g = svg.append('g')
          .attr('transform', `translate(${margin.left}, ${margin.top})`);
      const xAxisG = g.append('g')
          .attr('transform', `translate(0, ${innerHeight})`);
      const yAxisG = g.append('g');

      const xScale = d3.scaleLinear();
      const yScale = d3.scaleLinear();

      const xAxis = d3.axisBottom().ticks(15).scale(xScale);
      const yAxis = d3.axisLeft().ticks(15).scale(yScale);

      const row = d => {
        d.SO2 = +d.SO2;
        d.NO2 = +d.NO2;
        return d;
      };

      d3.csv('hydair.csv', row, data => {
        xScale
          .domain([0, d3.max(data, xValue)])
          .range([0, innerWidth]);

        yScale
          .domain([0, d3.max(data, yValue)])
          .range([innerHeight, 0]);

        g.selectAll('circle').data(data)
          .enter().append('circle')
            .attr('cx', d => xScale(xValue(d)))
            .attr('cy', d => yScale(yValue(d)))
            .attr('r', 2);

        xAxisG.call(xAxis);
        svg.append("text")
            .attr("transform", "translate(" + (width/2) + " ," +
                           (height + margin.top + 20) + ")")
            .style("text-anchor", "middle")
            .text("NO2 concentration (in ppb)");

        yAxisG.call(yAxis);
        svg.append("text")
            .attr("transform", "rotate(-90)")
            .attr("y", 0 - margin.left)
            .attr("x",0 - (height / 2))
            .attr("dy", "1em")
            .style("text-anchor", "middle")
            .text("SO2 concentration (in ppm)");


      });
    </script>
  </body>
</html>
